<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>文件破坏工具 - File Corruptor</title>
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- 主容器 -->
    <div class="container">
        <!-- 头部标题区 -->
        <header class="header">
            <div class="logo">
                <!-- 自定义SVG图标 -->
                <svg width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <rect x="8" y="8" width="24" height="24" stroke="black" stroke-width="2"/>
                    <line x1="12" y1="16" x2="28" y2="16" stroke="black" stroke-width="2"/>
                    <line x1="12" y1="20" x2="28" y2="20" stroke="black" stroke-width="2"/>
                    <line x1="12" y1="24" x2="28" y2="24" stroke="black" stroke-width="2"/>
                    <line x1="8" y1="8" x2="32" y2="32" stroke="black" stroke-width="2.5"/>
                </svg>
            </div>
            <h1 class="title">文件破坏工具</h1>
            <p class="subtitle">File Corruptor - 安全破坏任何格式文件</p>
        </header>

        <!-- 主要内容区 -->
        <main class="main-content">
            <!-- 模式切换选项卡 -->
            <div class="mode-tabs">
                <button class="mode-tab active" data-mode="corrupt">破坏模式</button>
                <button class="mode-tab" data-mode="restore">恢复模式</button>
            </div>

            <!-- 文件上传区 -->
            <section class="upload-section" aria-label="文件上传区域">
                <div class="upload-area" id="uploadArea" role="button" aria-label="点击或拖拽文件上传" tabindex="0">
                    <svg id="uploadIcon" width="60" height="60" viewBox="0 0 60 60" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                        <path d="M30 10 L30 40 M15 25 L30 10 L45 25" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <rect x="10" y="45" width="40" height="5" stroke="black" stroke-width="2"/>
                    </svg>
                    <p class="upload-text">点击或拖拽文件到此处</p>
                    <p class="upload-hint">支持格式：PDF, DOCX, CMD, PS1, LICENSE, DB, SIB, PNG, ZIP 等</p>
                    <p class="upload-hint" style="margin-top: 8px; color: var(--gray-600); font-size: 13px;">支持批量上传多个文件</p>
                    <input type="file" id="fileInput" class="file-input" accept="*/*" multiple aria-label="选择文件">
                </div>

                <!-- 打印机吐纸动画区 -->
                <div class="printer-animation" id="printerAnimation" style="display: none;">
                    <div class="printer-container">
                        <!-- 打印机 SVG -->
                        <svg class="printer" width="200" height="120" viewBox="0 0 200 120" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <!-- 打印机主体 -->
                            <rect x="40" y="30" width="120" height="60" stroke="black" stroke-width="2" fill="white"/>
                            <!-- 打印机顶部 -->
                            <rect x="50" y="10" width="100" height="25" stroke="black" stroke-width="2" fill="white"/>
                            <!-- 打印机控制面板 -->
                            <circle cx="70" cy="22" r="3" fill="black"/>
                            <circle cx="85" cy="22" r="3" fill="black"/>
                            <rect x="100" y="18" width="40" height="8" stroke="black" stroke-width="1" fill="white"/>
                            <!-- 打印机底座 -->
                            <rect x="30" y="90" width="140" height="8" stroke="black" stroke-width="2" fill="white"/>
                            <!-- 纸张出口 -->
                            <line x1="60" y1="90" x2="140" y2="90" stroke="black" stroke-width="1" stroke-dasharray="3,3"/>
                        </svg>

                        <!-- 纸张（从打印机吐出） -->
                        <div class="paper" id="animatedPaper">
                            <svg width="80" height="100" viewBox="0 0 80 100" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <rect x="2" y="2" width="76" height="96" stroke="black" stroke-width="2" fill="white"/>
                                <!-- 纸张折痕 -->
                                <line x1="10" y1="20" x2="70" y2="20" stroke="black" stroke-width="1" opacity="0.3"/>
                                <line x1="10" y1="30" x2="70" y2="30" stroke="black" stroke-width="1" opacity="0.3"/>
                                <line x1="10" y1="40" x2="70" y2="40" stroke="black" stroke-width="1" opacity="0.3"/>
                            </svg>
                            <span class="file-format-label" id="formatLabel"></span>
                        </div>

                        <!-- 纸张碎片容器 -->
                        <div class="paper-shards" id="paperShards"></div>
                    </div>
                </div>

                <!-- 文件信息显示 -->
                <div class="file-info" id="fileInfo" style="display: none;">
                    <div class="info-row">
                        <span class="info-label">文件名：</span>
                        <span class="info-value" id="fileName"></span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">文件大小：</span>
                        <span class="info-value" id="fileSize"></span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">文件类型：</span>
                        <span class="info-value" id="fileType"></span>
                    </div>
                </div>
            </section>

            <!-- 破坏选项区 -->
            <section class="options-section" id="optionsSection" style="display: none;">
                <h2 class="section-title">破坏程度</h2>
                <div class="corruption-levels">
                    <label class="level-option">
                        <input type="radio" name="level" value="light" checked>
                        <div class="level-card">
                            <div class="level-name">轻度破坏</div>
                            <div class="level-desc">修改文件头部，提示文件损坏</div>
                        </div>
                    </label>
                    <label class="level-option">
                        <input type="radio" name="level" value="medium">
                        <div class="level-card">
                            <div class="level-name">中度破坏</div>
                            <div class="level-desc">修改多处关键位置，无法识别</div>
                        </div>
                    </label>
                    <label class="level-option">
                        <input type="radio" name="level" value="heavy">
                        <div class="level-card">
                            <div class="level-name">重度破坏</div>
                            <div class="level-desc">随机修改大量数据，彻底损坏</div>
                        </div>
                    </label>
                </div>

                <div class="advanced-settings">
                    <details>
                        <summary>高级设置</summary>
                        <div class="advanced-options">
                            <label class="advanced-option">
                                <input type="checkbox" id="randomizeName">
                                <div>
                                    <div class="option-title">随机化输出文件名</div>
                                    <div class="option-desc">使用随机字符串重命名下载的文件，进一步隐藏原始信息。</div>
                                </div>
                            </label>
                            <label class="advanced-option">
                                <input type="checkbox" id="embedSignature" checked>
                                <div>
                                    <div class="option-title">嵌入破坏签名</div>
                                    <div class="option-desc">在文件内部写入不可见签名，增强不可恢复性。</div>
                                </div>
                            </label>
                            <label class="advanced-option">
                                <input type="checkbox" id="downloadReport">
                                <div>
                                    <div class="option-title">导出破坏报告</div>
                                    <div class="option-desc">生成一份 JSON 报告，记录破坏操作细节。</div>
                                </div>
                            </label>
                            <label class="advanced-option">
                                <input type="checkbox" id="reversibleMode">
                                <div>
                                    <div class="option-title">可逆破坏模式 [安全]</div>
                                    <div class="option-desc">使用AES-256加密技术安全保存修改记录，可通过密钥完全恢复原文件。</div>
                                </div>
                            </label>
                            <div class="password-input-wrapper" id="passwordInputWrapper" style="display: none;">
                                <div class="password-input-title">加密密钥</div>
                                <div class="password-input-desc">
                                    请输入强密码用于加密保护恢复数据。请务必记住此密钥，丢失后将无法恢复文件。
                                </div>
                                <input type="password" id="encryptionPassword" class="password-input" placeholder="输入密钥（至少8个字符）">
                                <input type="password" id="encryptionPasswordConfirm" class="password-input" placeholder="再次确认密钥">
                                <div class="password-strength" id="passwordStrength"></div>
                            </div>
                            <div class="advanced-option" style="display: block;">
                                <div class="option-title" style="margin-bottom: 8px;">处理速度档位</div>
                                <div class="option-desc" style="margin-bottom: 12px;">
                                    <span id="speedRecommendation">正在检测设备性能...</span>
                                </div>
                                <select id="processingSpeed" style="width: 100%; padding: 8px; border: 1px solid var(--gray-400); border-radius: 4px; font-family: 'SF Mono', monospace; font-size: 14px;">
                                    <option value="slow">低速 - 减少内存占用，适合低配设备</option>
                                    <option value="medium">中速 - 平衡性能与内存，适合普通设备</option>
                                    <option value="fast">高速 - 优先处理速度，适合高配设备</option>
                                    <option value="ultra">极速 - 最快速度，适合高性能设备</option>
                                </select>
                            </div>
                        </div>
                    </details>
                </div>

                <!-- 操作按钮 -->
                <div class="action-buttons">
                    <button class="btn btn-secondary" id="resetBtn">重新选择</button>
                    <button class="btn btn-primary" id="corruptBtn">破坏文件</button>
                </div>
            </section>

            <!-- 处理状态区 -->
            <section class="status-section" id="statusSection" style="display: none;" role="status" aria-live="polite">
                <div class="status-content">
                    <div class="spinner" aria-hidden="true"></div>
                    <p class="status-text" id="statusText">正在处理文件...</p>
                    
                    <!-- 进度条 -->
                    <div class="progress-container" id="progressContainer" style="display: none;">
                        <div class="progress-bar">
                            <div class="progress-fill" id="progressFill" style="width: 0%;"></div>
                        </div>
                        <div class="progress-info">
                            <span class="progress-percent" id="progressPercent">0%</span>
                            <span class="progress-time" id="progressTime"></span>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- 屏幕阅读器通知区域（视觉隐藏） -->
            <div class="sr-only" role="status" aria-live="assertive" aria-atomic="true" id="screenReaderAnnouncements"></div>

            <!-- 完成提示区 -->
            <section class="success-section" id="successSection" style="display: none;">
                <svg width="80" height="80" viewBox="0 0 80 80" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <circle cx="40" cy="40" r="35" stroke="black" stroke-width="2"/>
                    <path d="M25 40 L35 50 L55 30" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                <h3 class="success-title">文件已成功破坏！</h3>
                <p class="success-desc">损坏后的文件已自动下载</p>
                <div class="report-card" id="reportCard" style="display: none;"></div>
                <button class="btn btn-primary" id="continueBtn">继续破坏其他文件</button>
            </section>

            <!-- 恢复模式区域 -->
            <section class="restore-section" id="restoreSection" style="display: none;">
                <div class="restore-upload-area" id="restoreUploadArea">
                    <svg width="60" height="60" viewBox="0 0 60 60" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <circle cx="30" cy="30" r="20" stroke="black" stroke-width="2"/>
                        <path d="M30 20 L30 35 M25 30 L30 35 L35 30" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M20 45 L40 45" stroke="black" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                    <p class="upload-text">上传需要恢复的文件</p>
                    <p class="upload-hint">仅支持通过本工具可逆模式破坏的文件</p>
                    <input type="file" id="restoreFileInput" class="file-input" accept="*/*">
                </div>

                <!-- 恢复文件信息 -->
                <div class="restore-file-info" id="restoreFileInfo" style="display: none;">
                    <div class="info-row">
                        <span class="info-label">文件名：</span>
                        <span class="info-value" id="restoreFileName"></span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">文件大小：</span>
                        <span class="info-value" id="restoreFileSize"></span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">验证状态：</span>
                        <span class="info-value" id="restoreVerifyStatus"></span>
                    </div>
                </div>

                <!-- 密钥输入区 -->
                <div class="restore-password-section" id="restorePasswordSection" style="display: none;">
                    <h3 style="margin-bottom: 16px;">输入解密密钥</h3>
                    <input type="password" id="restorePassword" placeholder="输入创建时使用的加密密钥"
                        style="width: 100%; padding: 12px; border: 2px solid var(--gray-400); border-radius: 6px; font-family: 'SF Mono', monospace; font-size: 14px; margin-bottom: 16px;">
                    <div class="action-buttons">
                        <button class="btn btn-secondary" id="restoreCancelBtn">取消</button>
                        <button class="btn btn-primary" id="restoreBtn">恢复文件</button>
                    </div>
                </div>

                <!-- 恢复成功区 -->
                <div class="restore-success" id="restoreSuccess" style="display: none;">
                    <svg width="80" height="80" viewBox="0 0 80 80" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <circle cx="40" cy="40" r="35" stroke="green" stroke-width="2"/>
                        <path d="M25 40 L35 50 L55 30" stroke="green" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    <h3 class="success-title">文件已成功恢复！</h3>
                    <p class="success-desc">恢复后的原始文件已自动下载</p>
                    <button class="btn btn-primary" id="restoreAnotherBtn">恢复其他文件</button>
                </div>
            </section>
        </main>

        <!-- 底部说明 -->
        <footer class="footer">
            <div class="warning">
                <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M10 2 L18 17 L2 17 Z" stroke="black" stroke-width="1.5" stroke-linejoin="round"/>
                    <line x1="10" y1="8" x2="10" y2="12" stroke="black" stroke-width="1.5" stroke-linecap="round"/>
                    <circle cx="10" cy="14.5" r="0.5" fill="black"/>
                </svg>
                <span>本工具仅供学习测试使用，请勿用于不当用途。破坏后的文件无法恢复，请保留原文件备份。</span>
            </div>
            
            <div class="footer-links">
                <a href="privacy.html" class="footer-link">隐私政策</a>
                <span class="footer-divider">|</span>
                <a href="terms.html" class="footer-link">使用条款</a>
                <span class="footer-divider">|</span>
                <a href="disclaimer.html" class="footer-link">免责声明</a>
            </div>
            
            <div class="copyright">
                © 2025 Yuze Pan. All rights reserved.
            </div>
        </footer>
    </div>

            <!-- pako 压缩库 - 本地托管，保护用户隐私 -->
            <!-- 版本: 2.1.0 | 用途: 可逆模式数据压缩 -->
            <!-- 重要: 不使用CDN以确保完全本地运行，符合隐私政策 -->
            <script src="libs/pako.min.js"></script>
            
            <!-- Web Worker 预加载 - 用于后台密码学操作 -->
            <!-- 注意: Worker文件通过new Worker()动态加载，此处仅作预加载优化 -->
            <link rel="prefetch" href="crypto-worker.js" as="script">
            
            <script src="app.js"></script>
</body>
</html>
